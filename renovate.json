{
  "extends": [
    "config:recommended"
  ],
  "enabledManagers": [
    "flux",
    "helm-values",
    "custom.regex"
  ],
  "flux": {
    "managerFilePatterns": [
      "/^.*\\.ya?ml$/"
    ]
  },
  "helm-values": {
    "managerFilePatterns": [
      "/^.*values.*\\.ya?ml$/"
    ]
  },
  "customManagers": [
    {
      "customType": "regex",
      "managerFilePatterns": [
        "/vmagent.yaml/"
      ],
      "matchStrings": [
        "tag:\\s?(?<currentValue>[^\\s]+)"
      ],
      "datasourceTemplate": "docker",
      "depNameTemplate": "victoriametrics/vmagent",
      "versioningTemplate": "docker"
    },
    {
      "customType": "regex",
      "managerFilePatterns": [
        "/vmalert.yaml/"
      ],
      "matchStrings": [
        "tag:\\s?(?<currentValue>[^\\s]+)"
      ],
      "datasourceTemplate": "docker",
      "depNameTemplate": "victoriametrics/vmalert",
      "versioningTemplate": "docker"
    },
    {
      "customType": "regex",
      "managerFilePatterns": [
        "/vmalertmanager.yaml/"
      ],
      "matchStrings": [
        "tag:\\s?(?<currentValue>[^\\s]+)"
      ],
      "datasourceTemplate": "docker",
      "depNameTemplate": "prom/alertmanager",
      "versioningTemplate": "docker"
    },
    {
      "customType": "regex",
      "managerFilePatterns": [
        "/vmauth.yaml/"
      ],
      "matchStrings": [
        "tag:\\s?(?<currentValue>[^\\s]+)"
      ],
      "datasourceTemplate": "docker",
      "depNameTemplate": "victoriametrics/vmauth",
      "versioningTemplate": "docker"
    },
    {
      "customType": "regex",
      "managerFilePatterns": [
        "/^.*\\.ya?ml$/"
      ],
      "matchStrings": [
        "clusterVersion:\\s*(?<currentValue>v\\d+\\.\\d+\\.\\d+)-cluster"
      ],
      "depNameTemplate": "VictoriaMetrics/VictoriaMetrics",
      "datasourceTemplate": "github-tags",
      "description": "Track VictoriaMetrics clusterVersion (manual suffix update needed)"
    },
    {
      "customType": "regex",
      "managerFilePatterns": [
        "/vlcluster\\.yaml$/"
      ],
      "matchStrings": [
        "clusterVersion:\\s*(?<currentValue>v\\d+\\.\\d+\\.\\d+)"
      ],
      "depNameTemplate": "VictoriaMetrics/VictoriaLogs",
      "datasourceTemplate": "github-tags",
      "description": "Track VictoriaLogs clusterVersion"
    },
    {
      "customType": "regex",
      "managerFilePatterns": [
        "/vlagent\\.yaml$/"
      ],
      "matchStrings": [
        "tag:\\s?(?<currentValue>[^\\s]+)"
      ],
      "datasourceTemplate": "docker",
      "depNameTemplate": "victoriametrics/vlagent",
      "versioningTemplate": "docker",
      "description": "Track VLAgent Docker image"
    },
    {
      "customType": "regex",
      "managerFilePatterns": [
        "/^.*values.*\\.ya?ml$/",
        "/^.*\\.ya?ml$/"
      ],
      "matchStrings": [
        "# renovate: datasource=(?<datasource>.*?) depName=(?<depName>.*?)\\s*\\ntag:\\s*[\"']?(?<currentValue>[^\"'\\s]+)[\"']?",
        "# renovate: image=(?<depName>.*?)\\s*\\ntag:\\s*[\"']?(?<currentValue>[^\"'\\s]+)[\"']?"
      ],
      "datasourceTemplate": "docker",
      "description": "Update Docker images with renovate comments"
    }
  ],
  "packageRules": [
    {
      "matchManagers": [
        "flux"
      ],
      "matchUpdateTypes": [
        "minor",
        "patch"
      ],
      "automerge": true,
      "automergeType": "pr",
      "platformAutomerge": true,
      "minimumReleaseAge": "3 days"
    },
    {
      "matchManagers": [
        "helm-values"
      ],
      "matchUpdateTypes": [
        "patch"
      ],
      "automerge": true,
      "minimumReleaseAge": "3 days"
    },
    {
      "matchManagers": [
        "helm-values"
      ],
      "matchUpdateTypes": [
        "minor",
        "major"
      ],
      "automerge": false
    },
    {
      "matchManagers": [
        "custom.regex"
      ],
      "matchDepNames": [
        "VictoriaMetrics/VictoriaMetrics"
      ],
      "automerge": false,
      "description": "Manual review for VictoriaMetrics/VictoriaLogs versions"
    },
    {
      "matchManagers": [
        "custom.regex"
      ],
      "matchDatasources": [
        "docker"
      ],
      "matchUpdateTypes": [
        "patch"
      ],
      "automerge": true,
      "minimumReleaseAge": "2 days"
    }
  ],
  "prConcurrentLimit": 7,
  "prHourlyLimit": 9
}
